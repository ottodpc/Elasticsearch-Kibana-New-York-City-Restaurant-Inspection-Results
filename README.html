<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="nyc-restaurant-inspection-results-analysis-%F0%9F%93%8A%F0%9F%8D%BD%EF%B8%8F">NYC Restaurant Inspection Results Analysis üìäüçΩÔ∏è</h1>
<h2 id="description-%F0%9F%93%9D">Description üìù</h2>
<p>Ce projet vise √† analyser les donn√©es d'inspection des restaurants de New York √† l'aide de la pile Elastic (Elasticsearch, Kibana, Filebeat, Metricbeat, Logstash). En utilisant l'API Elastic et les visualisations Kibana, l'objectif est de r√©pondre √† une s√©rie de questions et d'explorer les violations les plus fr√©quentes dans les restaurants de la ville.</p>
<h2 id="table-des-mati%C3%A8res">Table des Mati√®res</h2>
<ol>
<li><a href="#instructions">Objectif</a></li>
<li><a href="#installation-et-configuration">Installation et Configuration</a></li>
<li><a href="#utilisation-du-projet">Utilisation du Projet</a></li>
<li><a href="#exemples-de-requ%C3%AAtes-et-visualisations">Exemples de Requ√™tes et Visualisations</a></li>
<li><a href="#cr%C3%A9ation-du-dashboard-kibana">Cr√©ation du Dashboard Kibana</a></li>
<li><a href="#exportation-du-rapport">Visualisation</a></li>
</ol>
<h2 id="objectif-%F0%9F%9B%A0%EF%B8%8F">Objectif üõ†Ô∏è</h2>
<p>L‚Äôobjectif est de r√©pondre aux questions en utilisant l'API Elastic et les visualisations Kibana.</p>
<p><strong>Liens de r√©f√©rence</strong> :</p>
<ul>
<li><a href="https://www.elastic.co/blog/getting-started-with-the-elastic-stack-and-docker-compose">Documentation Elastic Stack Setup</a></li>
<li><a href="https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j/about_data">Donn√©es d'√©tude : NYC Restaurant Inspection</a></li>
</ul>
<h2 id="installation-et-configuration-delasticsearch-et-kibana">Installation et Configuration d'Elasticsearch et Kibana</h2>
<h3 id="pr%C3%A9requis">Pr√©requis</h3>
<ul>
<li>Docker et Docker Compose</li>
<li>Donn√©es d'√©tude : NYC Restaurant Inspection</li>
</ul>
<h3 id="%C3%A9tapes-dinstallation">√âtapes d'Installation</h3>
<ol>
<li>
<p>Clonez le d√©p√¥t :</p>
<pre class="hljs"><code><div>git <span class="hljs-built_in">clone</span> https://github.com/ottodpc/Elasticsearch-Kibana-New-York-City-Restaurant-Inspection-Results.git
<span class="hljs-built_in">cd</span> Elasticsearch-Kibana-New-York-City-Restaurant-Inspection-Results
</div></code></pre>
</li>
<li>
<p>Configurez les variables d'environnement dans le fichier <code>.env</code> :</p>
<pre class="hljs"><code><div>ELASTIC_PASSWORD=ottodpc-azerty123
KIBANA_PASSWORD=ottodpc-azerty123
STACK_VERSION=8.7.1
CLUSTER_NAME=nyc-restaurants-cluster
LICENSE=basic
ES_PORT=9200
KIBANA_PORT=5601
ES_MEM_LIMIT=1073741824
KB_MEM_LIMIT=1073741824
ENCRYPTION_KEY=c34d38b3a14956121ff2170e5030b471551370178f43e5626eec58b04a30fae2
</div></code></pre>
</li>
<li>
<p>Lancez l'environnement Elastic Stack :</p>
<pre class="hljs"><code><div>docker-compose up -d --build
</div></code></pre>
<p><img src="./img/start.png" alt="Lancement Docker"></p>
</li>
</ol>
<h2 id="utilisation-du-projet">Utilisation du Projet</h2>
<ol>
<li>
<p>Acc√©dez √† Kibana sur <code>http://localhost:5601</code> et Elasticsearch sur <code>http://localhost:9200</code>.</p>
</li>
<li>
<p>Importez les donn√©es d'inspection de New York :</p>
<ul>
<li>Acc√©dez √† &quot;Integrations&quot; &gt; &quot;Upload file&quot; et s√©lectionnez le fichier <code>DOHMH_New_York_City_Restaurant_Inspection_Results.csv</code> via Kibana : <code>http://localhost:5601/app/home#/tutorial_directory/fileDataViz</code></li>
</ul>
<p><img src="./img/Elastic-upload-file-data.png" alt="Importation de donn√©es"></p>
<p><strong>Gestion des erreurs</strong> :</p>
<ul>
<li>En cas d'erreur de taille de fichier
<img src="./img/error_File_size_too_large.png" alt="Erreur Importation"></li>
<li>Augmenter la taille max.
<img src="./img/error_File_size_too_large_correction.png" alt="Erreur Importation Max size"></li>
</ul>
</li>
</ol>
<h2 id="exemples-de-requ%C3%AAtes-et-visualisations">Exemples de Requ√™tes et Visualisations</h2>
<h3 id="requ%C3%AAtes-elasticsearch-%F0%9F%94%8D">Requ√™tes Elasticsearch üîç</h3>
<h4 id="1-liste-des-quartiers-de-new-york">1. Liste des quartiers de New York</h4>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"neighborhoods"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"NTA"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1000</span>
      }
    }
  }
}
</div></code></pre>
<p><img src="./img/q1.png" alt="Requ√™te 1"></p>
<h4 id="2-quartier-avec-le-plus-de-restaurants">2. Quartier avec le plus de restaurants</h4>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"neighborhood_with_most_restaurants"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"NTA"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">"order"</span>: {
          <span class="hljs-attr">"_count"</span>: <span class="hljs-string">"desc"</span>
        }
      }
    }
  }
}
</div></code></pre>
<p><img src="./img/q2.png" alt="Requ√™te 2"></p>
<h4 id="3-mapping">3. Mapping</h4>
<pre class="hljs"><code><div>GET nyc_restaurants/_mapping
</div></code></pre>
<p><img src="./img/index_name_nyc_restaurants_mapping_request_test.png" alt="Requ√™te 3"></p>
<h3 id="autres-requ%C3%AAtes-et-explications">Autres Requ√™tes et Explications</h3>
<ul>
<li>
<p><strong>Questions avec des requ√™tes Elastic API</strong> :</p>
<ul>
<li>Q1 : List all the neighborhoods in New York.</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"neighborhoods"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"NTA"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1000</span>
      }
    }
  }
}
</div></code></pre>
<p><strong>Explication de la requ√™te :</strong></p>
<ul>
<li><strong>&quot;size&quot;: 0</strong> : Seulement des r√©sultats d'agr√©gation.</li>
<li><strong>&quot;aggs&quot;</strong> : Une agr√©gation pour regrouper les donn√©es.</li>
<li><strong>&quot;neighborhoods&quot;</strong> : Nom de l'agr√©gation, ici nous collectons les quartiers.</li>
<li><strong>&quot;terms&quot;</strong> : Type d'agr√©gation utilis√©e pour regrouper par termes uniques.</li>
<li><strong>&quot;field&quot;: &quot;NTA&quot;</strong> : Champ sur lequel l'agr√©gation est effectu√©e, repr√©sentant les quartiers.</li>
<li><strong>&quot;size&quot;: 1000</strong> : Nombre maximal de termes uniques √† retourner, pour s'assurer que tous les quartiers sont inclus.</li>
</ul>
<p><img src="./img/q1.png" alt="requete"></p>
<p>Le r√©sultat de la requ√™te montre une agr√©gation des quartiers (NTA - Neighborhood Tabulation Areas) de New York, avec chaque quartier identifi√© par un code (ex. &quot;MN17&quot;, &quot;BK37&quot;) et le nombre d'occurrences de restaurants ou d'inspections pour chacun.</p>
<ol>
<li>
<p><strong>Code du Quartier (key)</strong> : Chaque entr√©e (ou &quot;bucket&quot;) dans l'agr√©gation repr√©sente un quartier, identifi√© par son code unique. Par exemple :</p>
<ul>
<li><strong>&quot;MN17&quot;</strong> se r√©f√®re √† un quartier sp√©cifique dans Manhattan, avec un total de 14,356 documents.</li>
<li><strong>&quot;BK37&quot;</strong> indique un quartier √† Brooklyn avec 4,160 documents.</li>
</ul>
</li>
<li>
<p><strong>Nombre de Documents (doc_count)</strong> : Ce nombre montre combien de fois chaque quartier appara√Æt dans l'index &quot;nyc_restaurants&quot;. Un chiffre √©lev√© signifie qu'il y a beaucoup d'inspections ou de donn√©es concernant des restaurants dans cette zone. Ce champ peut √™tre utilis√© pour √©valuer la densit√© d'activit√©s de restauration ou d'inspections dans chaque quartier.</p>
</li>
</ol>
<ul>
<li>Q2 : Which neighborhood has the most restaurants?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"neighborhood_with_most_restaurants"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"NTA"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">"order"</span>: {
          <span class="hljs-attr">"_count"</span>: <span class="hljs-string">"desc"</span>
        }
      }
    }
  }
}
</div></code></pre>
<p><strong>Explication de la requ√™te :</strong></p>
<ol>
<li><strong>&quot;size&quot;: 0</strong> : Seulement des r√©sultats d'agr√©gation.</li>
<li><strong>&quot;aggs&quot;</strong> : Une agr√©gation pour r√©pondre √† la question.</li>
<li><strong>&quot;neighborhood_with_most_restaurants&quot;</strong> : Nom de l'agr√©gation utilis√©e pour regrouper les donn√©es par quartier.</li>
<li><strong>&quot;terms&quot;</strong> : Type d'agr√©gation, permettant de compter les occurrences de chaque quartier.</li>
<li><strong>&quot;field&quot;: &quot;NTA&quot;</strong> : Champ utilis√© pour identifier les quartiers.</li>
<li><strong>&quot;size&quot;: 1</strong> : Limite le retour au quartier ayant le plus grand nombre de documents.</li>
<li><strong>&quot;order&quot;: { &quot;_count&quot;: &quot;desc&quot; }</strong> : Tri d√©croissant par nombre de documents pour avoir le quartier avec le plus de restaurants en premier.</li>
</ol>
<p><img src="./img/q2.png" alt="requete"></p>
<p>Le quartier <strong>MN17</strong> a le plus grand nombre de restaurants dans l'ensemble de donn√©es. <strong>&quot;key&quot;: &quot;MN17&quot;</strong> : Ce code repr√©sente un quartier sp√©cifique de Manhattan (car &quot;MN&quot; correspond √† Manhattan). <strong>&quot;doc_count&quot;: 14356</strong> : Il y a 14,356 documents associ√©s √† ce quartier, ce qui repr√©sente le nombre total de restaurants dans cette zone. Cela signifie que MN17 est la zone avec le plus grand nombre de restaurants enregistr√©s dans l'index.</p>
<ul>
<li>Q3 : What does the violation code &quot;04N&quot; correspond to?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"term"</span>: {
      <span class="hljs-attr">"VIOLATION CODE"</span>: <span class="hljs-string">"04N"</span>
    }
  },
  <span class="hljs-attr">"_source"</span>: [<span class="hljs-string">"VIOLATION DESCRIPTION"</span>],
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>
}
</div></code></pre>
<p><strong>Explication de la requ√™te :</strong></p>
<ol>
<li><strong>&quot;query&quot;: { &quot;term&quot;: { &quot;VIOLATION CODE&quot;: &quot;04N&quot; } }</strong> : Nous utilisons une requ√™te <code>term</code> pour rechercher exactement le code de violation &quot;04N&quot; dans le champ <code>VIOLATION CODE</code>.</li>
<li><strong>&quot;_source&quot;: [&quot;VIOLATION DESCRIPTION&quot;]</strong> : Nous limitons les champs retourn√©s aux seules descriptions des violations (pour r√©duire le volume de donn√©es inutiles).</li>
<li><strong>&quot;size&quot;: 1</strong> : Cette valeur est fix√©e √† 1 car nous n'avons besoin que d'un document pour obtenir la description du code &quot;04N&quot;.</li>
</ol>
<p><img src="./img/q3.png" alt="requete"></p>
<p>Cette description montre que la violation &quot;04N&quot; est li√©e √† des infestations de mouches ou autres nuisances de type insectes dans des zones o√π cela pourrait pr√©senter un risque pour l'hygi√®ne alimentaire. Cette information est essentielle pour comprendre le type de probl√®me que &quot;04N&quot; repr√©sente dans le contexte des inspections sanitaires des restaurants, car elle concerne des insectes nuisibles qui pourraient compromettre la s√©curit√© alimentaire.</p>
<ul>
<li>Q4 : Where are the restaurants (name, address, neighborhood) that have a grade of A?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"term"</span>: {
      <span class="hljs-attr">"GRADE"</span>: <span class="hljs-string">"A"</span>
    }
  },
  <span class="hljs-attr">"_source"</span>: [<span class="hljs-string">"DBA"</span>, <span class="hljs-string">"BUILDING"</span>, <span class="hljs-string">"STREET"</span>, <span class="hljs-string">"ZIPCODE"</span>, <span class="hljs-string">"NTA"</span>],
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">100</span>
}
</div></code></pre>
<h3 id="la-requ%C3%AAte">La requ√™te :</h3>
<ol>
<li><strong>&quot;query&quot;: { &quot;term&quot;: { &quot;GRADE&quot;: &quot;A&quot; } }</strong> : La requ√™te utilise un filtre <code>term</code> pour s√©lectionner uniquement les documents o√π le champ <code>GRADE</code> est √©gal √† &quot;A&quot;.</li>
<li><strong>&quot;_source&quot;: [&quot;DBA&quot;, &quot;BUILDING&quot;, &quot;STREET&quot;, &quot;ZIPCODE&quot;, &quot;NTA&quot;]</strong> : Nous limitons les champs retourn√©s aux informations essentielles :
<ul>
<li><strong>&quot;DBA&quot;</strong> : Nom du restaurant.</li>
<li><strong>&quot;BUILDING&quot;</strong> et <strong>&quot;STREET&quot;</strong> : Adresse du restaurant.</li>
<li><strong>&quot;ZIPCODE&quot;</strong> : Code postal pour plus de pr√©cision.</li>
<li><strong>&quot;NTA&quot;</strong> : Quartier (Neighborhood Tabulation Area) o√π le restaurant est situ√©.</li>
</ul>
</li>
<li><strong>&quot;size&quot;: 100</strong> : Limite le nombre de r√©sultats retourn√©s √† 100 pour √©viter de surcharger la r√©ponse. Il est possible d'ajuster cette limite si n√©cessaire.</li>
</ol>
<p><img src="./img/q4.png" alt="requete"></p>
<p>Le r√©sultat pr√©sente une liste de restaurants not√©s &quot;A&quot;, class√©s sans ordre sp√©cifique. Chaque entr√©e fournit :</p>
<p><strong>Nom du restaurant*</strong> : Permet de reconna√Ætre l‚Äô√©tablissement (utile pour des recommandations ou des analyses de qualit√©).
<strong><em>Adresse compl√®te</em></strong> : Inclut le num√©ro de b√¢timent, la rue et le code postal, facilitant la localisation g√©ographique.
<strong><em>Quartier</em></strong> : Le code NTA permet de situer chaque restaurant dans un quartier pr√©cis de New York, ce qui peut aider √† analyser la distribution de la note A dans les diff√©rents quartiers.</p>
<ul>
<li>Q5 : What is the most popular cuisine? And by neighborhood?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"most_popular_cuisine"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"CUISINE DESCRIPTION"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">"order"</span>: {
          <span class="hljs-attr">"_count"</span>: <span class="hljs-string">"desc"</span>
        }
      }
    },
    <span class="hljs-attr">"popular_cuisine_by_neighborhood"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"NTA"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">100</span>
      },
      <span class="hljs-attr">"aggs"</span>: {
        <span class="hljs-attr">"top_cuisine_in_neighborhood"</span>: {
          <span class="hljs-attr">"terms"</span>: {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"CUISINE DESCRIPTION"</span>,
            <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-attr">"order"</span>: {
              <span class="hljs-attr">"_count"</span>: <span class="hljs-string">"desc"</span>
            }
          }
        }
      }
    }
  }
}
</div></code></pre>
<p><img src="./img/q5.png" alt="requete"></p>
<p>Le r√©sultat r√©v√®le une forte pr√©valence de la cuisine am√©ricaine, tant au niveau global qu‚Äôau sein de nombreux quartiers sp√©cifiques. Cependant, certains quartiers montrent des pr√©f√©rences culinaires diff√©rentes, refl√©tant une diversit√© culturelle. Par exemple :</p>
<ul>
<li><strong>Cuisine chinoise</strong> dans certains quartiers de Queens (ex. QN22).</li>
<li><strong>Cuisine carib√©enne</strong> dans plusieurs quartiers de Brooklyn (ex. BK61, BK50).</li>
<li><strong>Cuisine Jewish/Kosher</strong> √©galement bien repr√©sent√©e dans certains quartiers de Brooklyn (BK25, BK88).</li>
</ul>
<p>Cela montre non seulement les pr√©f√©rences globales, mais aussi des pr√©f√©rences culinaires sp√©cifiques √† chaque quartier, permettant une analyse pr√©cise de la r√©partition des types de cuisines √† travers la ville de New York.</p>
<ul>
<li>Q6 : What is the date of the last inspection?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">"sort"</span>: [
    {
      <span class="hljs-attr">"INSPECTION DATE"</span>: {
        <span class="hljs-attr">"order"</span>: <span class="hljs-string">"desc"</span>
      }
    }
  ],
  <span class="hljs-attr">"_source"</span>: [<span class="hljs-string">"INSPECTION DATE"</span>]
}
</div></code></pre>
<h3 id="la-requ%C3%AAte">La requ√™te :</h3>
<ol start="2">
<li><strong>&quot;sort&quot;</strong> : Nous trions les documents par date d‚Äôinspection (<code>INSPECTION DATE</code>) en ordre d√©croissant (<code>&quot;order&quot;: &quot;desc&quot;</code>), de sorte que la date la plus r√©cente apparaisse en premier.</li>
<li><strong>&quot;_source&quot;: [&quot;INSPECTION DATE&quot;]</strong> : Nous limitons le retour aux informations sur la date d‚Äôinspection uniquement, pour r√©duire le volume de donn√©es inutiles.</li>
</ol>
<p><img src="./img/q6.png" alt="requete"></p>
<p>Le r√©sultat montre que la derni√®re inspection enregistr√©e a eu lieu le <strong>11 juillet 2024</strong>.</p>
<ul>
<li>Q7 : Provide a list of Chinese restaurants with an A grade in Brooklyn.</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"bool"</span>: {
      <span class="hljs-attr">"must"</span>: [
        { <span class="hljs-attr">"term"</span>: { <span class="hljs-attr">"GRADE"</span>: <span class="hljs-string">"A"</span> } },
        { <span class="hljs-attr">"term"</span>: { <span class="hljs-attr">"CUISINE DESCRIPTION"</span>: <span class="hljs-string">"Chinese"</span> } },
        { <span class="hljs-attr">"term"</span>: { <span class="hljs-attr">"BORO"</span>: <span class="hljs-string">"BROOKLYN"</span> } }
      ]
    }
  },
  <span class="hljs-attr">"_source"</span>: [<span class="hljs-string">"DBA"</span>, <span class="hljs-string">"BUILDING"</span>, <span class="hljs-string">"STREET"</span>, <span class="hljs-string">"ZIPCODE"</span>, <span class="hljs-string">"CUISINE DESCRIPTION"</span>, <span class="hljs-string">"GRADE"</span>],
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">100</span>
}
</div></code></pre>
<h3 id="la-requ%C3%AAte">La requ√™te :</h3>
<ol>
<li>
<p><strong>&quot;query&quot;: { &quot;bool&quot;: { &quot;must&quot;: [...] } }</strong> : Nous utilisons une requ√™te bool√©enne avec des conditions <code>must</code> pour filtrer selon plusieurs crit√®res.</p>
<ul>
<li><strong>{ &quot;term&quot;: { &quot;GRADE&quot;: &quot;A&quot; } }</strong> : Filtre les restaurants ayant une note &quot;A&quot;.</li>
<li><strong>{ &quot;term&quot;: { &quot;CUISINE DESCRIPTION&quot;: &quot;Chinese&quot; } }</strong> : Filtre les restaurants de cuisine chinoise.</li>
<li><strong>{ &quot;term&quot;: { &quot;BORO&quot;: &quot;BROOKLYN&quot; } }</strong> : Limite les r√©sultats aux restaurants situ√©s dans le quartier de Brooklyn.</li>
</ul>
</li>
<li>
<p><strong>&quot;_source&quot;: [...]</strong> : Limite les champs retourn√©s aux informations n√©cessaires :</p>
<ul>
<li><strong>&quot;DBA&quot;</strong> : Nom commercial du restaurant.</li>
<li><strong>&quot;BUILDING&quot;</strong> et <strong>&quot;STREET&quot;</strong> : Adresse du restaurant.</li>
<li><strong>&quot;ZIPCODE&quot;</strong> : Code postal.</li>
<li><strong>&quot;CUISINE DESCRIPTION&quot;</strong> et <strong>&quot;GRADE&quot;</strong> : Confirme la cuisine et la note.</li>
</ul>
</li>
<li>
<p><strong>&quot;size&quot;: 100</strong> : Retourne jusqu'√† 100 r√©sultats. Ce nombre peut √™tre ajust√© selon le besoin.</p>
</li>
</ol>
<p><img src="./img/q7.png" alt="requete"></p>
<p>Aucun restaurant ne correspond aux crit√®res de recherche. L'absence de r√©sultats peut signifier plusieurs choses :</p>
<ul>
<li>
<p><strong>Aucun restaurant chinois avec une note A</strong> n'a √©t√© enregistr√© √† Brooklyn dans cet index particulier. Cela peut √™tre d√ª √† un manque de donn√©es pour cette combinaison sp√©cifique dans l'index &quot;nyc_restaurants&quot;.</p>
</li>
<li>
<p><strong>Probl√®me potentiel de donn√©es</strong> : Il est possible que les informations ne soient pas compl√®tement mises √† jour ou que la nomenclature soit incorrecte dans certains champs (par exemple, des variations dans les noms des cuisines ou dans la fa√ßon dont le borough est cod√©).</p>
<ul>
<li>
<p>Q8 : What is the address of the restaurant LADUREE?
IMAGES :</p>
</li>
<li>
<p>requete ./img/q8.png</p>
<p>Pour obtenir l'adresse du restaurant <strong>LADUREE</strong>, voici la requ√™te Elasticsearch appropri√©e pour Kibana DevTools :</p>
</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"match"</span>: {
      <span class="hljs-attr">"DBA"</span>: <span class="hljs-string">"LADUREE"</span>
    }
  },
  <span class="hljs-attr">"_source"</span>: [<span class="hljs-string">"DBA"</span>, <span class="hljs-string">"BUILDING"</span>, <span class="hljs-string">"STREET"</span>, <span class="hljs-string">"ZIPCODE"</span>, <span class="hljs-string">"BORO"</span>],
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>
}
</div></code></pre>
<h3 id="la-requ%C3%AAte">la requ√™te :</h3>
<ol>
<li><strong>&quot;query&quot;: { &quot;match&quot;: { &quot;DBA&quot;: &quot;LADUREE&quot; } }</strong> : Utilisation d‚Äôune requ√™te <code>match</code> pour rechercher le nom &quot;LADUREE&quot; dans le champ <code>DBA</code> (nom commercial).</li>
<li><strong>&quot;_source&quot;: [...]</strong> : Limitation des champs retourn√©s aux informations d‚Äôadresse essentielles :
<ul>
<li><strong>&quot;DBA&quot;</strong> : Nom commercial (pour confirmation),</li>
<li><strong>&quot;BUILDING&quot;</strong> et <strong>&quot;STREET&quot;</strong> : Num√©ro et rue de l‚Äôadresse,</li>
<li><strong>&quot;ZIPCODE&quot;</strong> : Code postal,</li>
<li><strong>&quot;BORO&quot;</strong> : Arrondissement (borough) du restaurant.</li>
</ul>
</li>
<li><strong>&quot;size&quot;: 1</strong> : Nous limitons le retour √† un seul document, car nous ne cherchons qu‚Äôune seule occurrence pour &quot;LADUREE&quot;.</li>
</ol>
<p><img src="./img/q8.png" alt="requete"></p>
<p>Le r√©sultat montre qu‚Äôun restaurant <strong>Laduree</strong> est situ√© au <strong>20 Hudson Yards, Manhattan, New York, 10001</strong>.</p>
<ul>
<li>Q9 : What cuisine is most affected by the violation &quot;Hot food item not held at or above 140¬∫ F&quot;?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"query"</span>: {
    <span class="hljs-attr">"match"</span>: {
      <span class="hljs-attr">"VIOLATION DESCRIPTION"</span>: <span class="hljs-string">"Hot food item not held at or above 140¬∫ F"</span>
    }
  },
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"most_affected_cuisine"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"CUISINE DESCRIPTION"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">"order"</span>: {
          <span class="hljs-attr">"_count"</span>: <span class="hljs-string">"desc"</span>
        }
      }
    }
  }
}
</div></code></pre>
<h3 id="la-requ%C3%AAte">La requ√™te :</h3>
<ol>
<li><strong>&quot;size&quot;: 0</strong> : Nous n'avons pas besoin des documents individuels, seulement des r√©sultats d'agr√©gation.</li>
<li><strong>&quot;query&quot;</strong> : Filtre pour s√©lectionner les documents qui contiennent la description de violation &quot;Hot food item not held at or above 140¬∫ F&quot;.
<ul>
<li><strong>&quot;match&quot;: { &quot;VIOLATION DESCRIPTION&quot;: &quot;Hot food item not held at or above 140¬∫ F&quot; }</strong> : Utilise une requ√™te <code>match</code> pour rechercher la description exacte de la violation.</li>
</ul>
</li>
<li><strong>&quot;aggs&quot;</strong> : D√©finition de l'agr√©gation pour identifier le type de cuisine le plus fr√©quemment associ√© √† cette violation.
<ul>
<li><strong>&quot;most_affected_cuisine&quot;</strong> : Nom de l'agr√©gation pour collecter les informations.</li>
<li><strong>&quot;terms&quot;</strong> : Type d'agr√©gation <code>terms</code> qui regroupe par cuisine.
<ul>
<li><strong>&quot;field&quot;: &quot;CUISINE DESCRIPTION&quot;</strong> : Champ utilis√© pour identifier les types de cuisine.</li>
<li><strong>&quot;size&quot;: 1</strong> : Limite le retour au type de cuisine le plus fr√©quent pour cette violation.</li>
<li><strong>&quot;order&quot;: { &quot;_count&quot;: &quot;desc&quot; }</strong> : Trie par ordre d√©croissant pour obtenir le type de cuisine le plus touch√© en premier.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="./img/q9.png" alt="requete"></p>
<p>Le r√©sultat de la requ√™te montre que la cuisine <strong>am√©ricaine</strong> est la plus affect√©e par la violation <strong>&quot;Hot food item not held at or above 140¬∫ F&quot;</strong> dans les donn√©es des restaurants de New York. Ce chiffre √©lev√© de 39,570 occurrences pourrait indiquer une vigilance accrue n√©cessaire dans la gestion de la temp√©rature des plats dans les restaurants de cuisine am√©ricaine, par rapport √† d'autres types de cuisines.</p>
<ol>
<li>
<p><strong>R√©sum√© de la requ√™te</strong> :</p>
<ul>
<li><code>&quot;took&quot;: 390</code> : La requ√™te a pris 390 millisecondes pour s'ex√©cuter.</li>
<li><code>&quot;timed_out&quot;: false</code> : La requ√™te s‚Äôest termin√©e sans d√©lai d‚Äôattente.</li>
<li><code>_shards</code> : La requ√™te a √©t√© ex√©cut√©e sans √©chec sur un seul fragment, confirmant que tous les r√©sultats sont disponibles.</li>
</ul>
</li>
<li>
<p><strong>R√©sultats de la recherche (hits)</strong> :</p>
<ul>
<li><code>&quot;total&quot;: { &quot;value&quot;: 10000, &quot;relation&quot;: &quot;gte&quot; }</code> : L‚Äôindex contient au moins 10,000 documents correspondant √† cette violation.</li>
<li><code>&quot;max_score&quot;: null</code> et <code>&quot;hits&quot;: []</code> : Aucun document individuel n'est retourn√©, car la requ√™te a √©t√© configur√©e pour ne retourner que les agr√©gations.</li>
</ul>
</li>
<li>
<p><strong>Agr√©gation &quot;most_affected_cuisine&quot;</strong> :</p>
<ul>
<li><strong>&quot;doc_count_error_upper_bound&quot;: 0</strong> : Il n‚Äôy a pas d'erreur dans le comptage, ce qui signifie que les r√©sultats sont exacts.</li>
<li><strong>&quot;sum_other_doc_count&quot;: 205191</strong> : Le nombre total de documents associ√©s √† d'autres types de cuisines affect√©s par cette violation s'√©l√®ve √† 205,191, montrant que de nombreuses autres cuisines sont √©galement concern√©es.</li>
<li><strong>&quot;buckets&quot;</strong> : Contient les r√©sultats class√©s des cuisines les plus affect√©es.
<ul>
<li><strong>&quot;key&quot;: &quot;American&quot;</strong> : La cuisine am√©ricaine est la plus touch√©e par cette violation.</li>
<li><strong>&quot;doc_count&quot;: 39570</strong> : La violation <strong>&quot;Hot food item not held at or above 140¬∫ F&quot;</strong> a √©t√© enregistr√©e 39,570 fois dans des restaurants de cuisine am√©ricaine, ce qui en fait la cuisine la plus affect√©e par cette infraction.</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li>Q10 : What are the most common violations (Top 5)?</li>
</ul>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"top_violations"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"VIOLATION CODE"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">5</span>
      },
      <span class="hljs-attr">"aggs"</span>: {
        <span class="hljs-attr">"violation_description"</span>: {
          <span class="hljs-attr">"top_hits"</span>: {
            <span class="hljs-attr">"_source"</span>: {
              <span class="hljs-attr">"includes"</span>: [<span class="hljs-string">"VIOLATION DESCRIPTION"</span>]
            },
            <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>
          }
        }
      }
    }
  }
}
</div></code></pre>
<ul>
<li><strong>&quot;size&quot;: 0</strong>¬†: Nous d√©finissons cette valeur sur z√©ro car nous ne nous int√©ressons qu'aux r√©sultats de l'agr√©gation, pas aux documents individuels.</li>
<li><strong>Agr√©gation sur <code>VIOLATION CODE</code></strong>¬†:
<ul>
<li><strong>&quot;field&quot;: &quot;VIOLATION CODE&quot;</strong>¬†: regroupe les documents en fonction des codes de violation.</li>
<li><strong>&quot;size&quot;: 5</strong>¬†: limite l'agr√©gation aux 5 codes de violation les plus courants.</li>
</ul>
</li>
<li><strong>Sous-agr√©gation <code>violation_description</code></strong>¬†:
<ul>
<li><strong>&quot;top_hits&quot;</strong>¬†: r√©cup√®re les principaux documents pour chaque compartiment.</li>
<li><strong>&quot;_source&quot;: { &quot;includes&quot;: [&quot;VIOLATION DESCRIPTION&quot;] }</strong>¬†: Inclut uniquement le champ <code>VIOLATION DESCRIPTION</code> dans les r√©sultats.</li>
<li><strong>&quot;size&quot;: 1</strong> : R√©cup√®re un document par code de violation, en supposant que la description est coh√©rente pour chaque code.</li>
</ul>
</li>
</ul>
<p><img src="./img/q10.png" alt="requete"></p>
<p>La requ√™te identifie avec succ√®s les cinq violations les plus courantes du code de la sant√© dans les restaurants de New York, offrant ainsi des informations pr√©cieuses sur les domaines qui n√©cessitent une attention imm√©diate pour prot√©ger la sant√© publique. En tenant compte de la pr√©cision et du rappel, nous garantissons que les r√©sultats sont exacts et complets, r√©pondant directement √† la question initiale.</p>
<ul>
<li>Q11 : What is the most popular restaurant chain?</li>
</ul>
<p><img src="./img/q11_error.png" alt="requete"><br>
<img src="./img/q11_correct.png" alt="requete"></p>
<h3 id="%C3%A9tape-1--mettre-%C3%A0-jour-le-mappage-pour-inclure-%C2%AB-dbakeyword-%C2%BB">√âtape 1¬†: Mettre √† jour le mappage pour inclure ¬´¬†DBA.keyword¬†¬ª</h3>
<ol>
<li>
<p><strong>Cr√©ez un nouvel index avec le mappage mis √† jour</strong>. Cet index aura le champ ¬´ DBA ¬ª mis √† jour pour inclure un sous-champ ¬´ key ¬ª pour les agr√©gations.</p>
<pre class="hljs"><code><div>PUT nyc_restaurants_v2
{
  <span class="hljs-attr">"mappings"</span>: {
    <span class="hljs-attr">"properties"</span>: {
      <span class="hljs-attr">"@timestamp"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"date"</span>
      },
      <span class="hljs-attr">"ACTION"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"text"</span>
      },
      <span class="hljs-attr">"BBL"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"BIN"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"BORO"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"BUILDING"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"CAMIS"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"CRITICAL FLAG"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"CUISINE DESCRIPTION"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"Census Tract"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"Community Board"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"Council District"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"DBA"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"text"</span>,
        <span class="hljs-attr">"fields"</span>: {
          <span class="hljs-attr">"keyword"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>,
            <span class="hljs-attr">"ignore_above"</span>: <span class="hljs-number">256</span>
          }
        }
      },
      <span class="hljs-attr">"GRADE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"GRADE DATE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"date"</span>,
        <span class="hljs-attr">"format"</span>: <span class="hljs-string">"MM/dd/yyyy"</span>
      },
      <span class="hljs-attr">"INSPECTION DATE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"date"</span>,
        <span class="hljs-attr">"format"</span>: <span class="hljs-string">"MM/dd/yyyy"</span>
      },
      <span class="hljs-attr">"INSPECTION TYPE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"Latitude"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"double"</span>
      },
      <span class="hljs-attr">"Longitude"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"double"</span>
      },
      <span class="hljs-attr">"NTA"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"PHONE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"RECORD DATE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"date"</span>,
        <span class="hljs-attr">"format"</span>: <span class="hljs-string">"MM/dd/yyyy"</span>
      },
      <span class="hljs-attr">"SCORE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"long"</span>
      },
      <span class="hljs-attr">"STREET"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"VIOLATION CODE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"VIOLATION DESCRIPTION"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"text"</span>
      },
      <span class="hljs-attr">"ZIPCODE"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"keyword"</span>
      },
      <span class="hljs-attr">"location"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"geo_point"</span>
      }
    }
  }
}
</div></code></pre>
</li>
<li>
<p><strong>R√©indexez les donn√©es de l'ancien index (<code>nyc_restaurants</code>) vers le nouvel index (<code>nyc_restaurants_v2</code>)</strong>¬†:</p>
<pre class="hljs"><code><div>POST _reindex
{
  <span class="hljs-attr">"source"</span>: {
    <span class="hljs-attr">"index"</span>: <span class="hljs-string">"nyc_restaurants"</span>
  },
  <span class="hljs-attr">"dest"</span>: {
    <span class="hljs-attr">"index"</span>: <span class="hljs-string">"nyc_restaurants_v2"</span>
  }
}
</div></code></pre>
</li>
<li>
<p><strong>Supprimer l'ancien index</strong></p>
<pre class="hljs"><code><div>DELETE nyc_restaurants
</div></code></pre>
</li>
<li>
<p><strong>Renommer l'index</strong></p>
<pre class="hljs"><code><div>POST /_aliases
{
  <span class="hljs-attr">"actions"</span>: [
    { <span class="hljs-attr">"remove"</span>: { <span class="hljs-attr">"index"</span>: <span class="hljs-string">"nyc_restaurants_v2"</span>, <span class="hljs-attr">"alias"</span>: <span class="hljs-string">"nyc_restaurants"</span> } },
    { <span class="hljs-attr">"add"</span>: { <span class="hljs-attr">"index"</span>: <span class="hljs-string">"nyc_restaurants_v2"</span>, <span class="hljs-attr">"alias"</span>: <span class="hljs-string">"nyc_restaurants"</span> } }
  ]
}
</div></code></pre>
</li>
</ol>
<h3 id="step-2-ex%C3%A9cution-de-la-requ%C3%AAte-dagr%C3%A9gation-pour-trouver-la-cha%C3%AEne-de-restaurants-la-plus-populaire">Step 2: Ex√©cution de la requ√™te d'agr√©gation pour trouver la cha√Æne de restaurants la plus populaire</h3>
<p>Maintenant que nous avons r√©index√© avec le mappage correct, nous pouvons utiliser la requ√™te suivante pour trouver la cha√Æne de restaurants la plus populaire en comptant les occurrences uniques de ¬´¬†DBA.keyword¬†¬ª:</p>
<pre class="hljs"><code><div>GET nyc_restaurants/_search
{
  <span class="hljs-attr">"size"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"aggs"</span>: {
    <span class="hljs-attr">"popular_restaurants"</span>: {
      <span class="hljs-attr">"terms"</span>: {
        <span class="hljs-attr">"field"</span>: <span class="hljs-string">"DBA.keyword"</span>,
        <span class="hljs-attr">"size"</span>: <span class="hljs-number">1</span>
      },
      <span class="hljs-attr">"aggs"</span>: {
        <span class="hljs-attr">"unique_locations"</span>: {
          <span class="hljs-attr">"cardinality"</span>: {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"CAMIS"</span>
          }
        }
      }
    }
  }
}
</div></code></pre>
<ol>
<li><strong>Cha√Æne la plus populaire par emplacements uniques</strong> : avec ¬´ 366 ¬ª emplacements uniques, ¬´ DUNKIN ¬ª est la cha√Æne de restaurants la plus populaire de l'ensemble de donn√©es.</li>
<li><strong>Fr√©quence des inspections ou des enregistrements</strong>¬†: Le ¬´ doc_count ¬ª de ¬´ 3193 ¬ª sugg√®re que les sites Dunkin ont eu plusieurs enregistrements ou inspections dans l'ensemble de donn√©es, ce qui refl√®te la grande pr√©sence de la cha√Æne √† New York.</li>
</ol>
<h2 id="cr%C3%A9ation-du-dashboard-kibana">Cr√©ation du Dashboard Kibana</h2>
<ol>
<li>
<p><strong>Ajoutez des filtres</strong> sur le type de cuisine, le quartier, et le grade pour affiner les r√©sultats.</p>
</li>
<li>
<p><strong>Cr√©ation de visualisations</strong> :</p>
<ul>
<li>Utilisez des cartes pour afficher la r√©partition g√©ographique des types de cuisine.</li>
<li>Ajoutez des graphiques pour les violations les plus fr√©quentes et les grades par quartier.</li>
</ul>
<p><img src="./img/Cuisine-type-Neighborhood-Rank_map.png" alt="Carte des Types de Cuisine"></p>
</li>
</ol>
<p><strong>Export de la visualisation Kibana</strong> :</p>
<ul>
<li><a href="./data/export/Cuisinetype-Neighborhood-Rank-MAP-VISUALISATION.ndjson">Visualisation Kibana</a></li>
</ul>
<p>üë§ <strong>Auteur</strong> : OTTO Dieu-Puissant Cyprien</p>

</body>
</html>
